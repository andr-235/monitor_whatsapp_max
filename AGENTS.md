# AGENTS.md

## Область
- В репозитории два сервиса: `worker` (опрос WhatsApp) и `bot` (Telegram).
- Общий код находится в `shared`, миграции — в `database`.
- Используйте Poetry для зависимостей и скриптов.

## Настройка
- Скопируйте `.env.example` в `.env` и заполните токены/доступы.
- Установите зависимости: `poetry install`.
- Запустите миграции: `poetry run alembic -c database/alembic.ini upgrade head`.

## Запуск
- Сервис `worker`: `poetry run worker`
- Сервис `bot`: `poetry run bot`
- Docker: `docker-compose up --build`

## Конвенции
- Держите аннотации типов и докстринги для публичных функций/классов.
- Разделяйте бизнес-логику и инфраструктуру; переиспользуйте `shared`.
- Храните строковые константы в config/constants, а не внутри кода.
- Используйте не-ASCII только когда это оправдано (например, русские сообщения).
- Используйте структурированное логирование; избегайте `print()`.

## Проверка состояния
- `/health` у worker (порт по умолчанию `8081`) и bot (`8082`).

## Опрос WhatsApp
- Только опрос (без вебхуков), интервал по умолчанию 600с.
- Авторизация API: `Authorization: Bearer <token>`.

## Быстрая проверка
- `python -m compileall .`
